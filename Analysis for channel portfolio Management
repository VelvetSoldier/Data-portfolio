# Channel portfolio

SELECT 
    Year(created_at) AS Years,
    Month(created_at) AS Months,
    COUNT(DISTINCT website_session_id) as Sessions,
    COUNT(DISTINCT CASE WHEN utm_campaign = "nonbrand" THEN website_session_id else null end) AS Nonbrand,
	COUNT(DISTINCT CASE WHEN utm_campaign = "brand" THEN website_session_id else null end) AS Brand, 
    COUNT(DISTINCT CASE WHEN utm_campaign = "brand"  THEN website_session_id else null end) / COUNT(DISTINCT CASE WHEN utm_campaign = "nonbrand" THEN website_session_id else null end) AS brand_d_nonbrand,
    COUNT(DISTINCT CASE WHEN utm_source is NULL AND http_referer IS NULL THEN website_session_id else null end) AS Direct_typing,
	COUNT(DISTINCT CASE WHEN utm_source is NULL AND http_referer IS NULL THEN website_session_id else null end) / COUNT(DISTINCT CASE WHEN utm_campaign = "nonbrand" THEN website_session_id else null end) AS Direct_d_nonbrand,
	COUNT(DISTINCT CASE WHEN utm_source is NULL AND http_referer IN( "https://www.gsearch.com", "https://ww.bsearch.com") THEN website_session_id else null end) AS Organic_search,
    COUNT(DISTINCT CASE WHEN utm_source is NULL AND http_referer IN( "https://www.gsearch.com", "https://ww.bsearch.com") THEN website_session_id else null end) / COUNT(DISTINCT CASE WHEN utm_campaign = "nonbrand" THEN website_session_id else null end) AS Organic_d_nonbrand
FROM
    website_sessions
WHERE
     created_at < '2012-12-23'
Group by Years , Months;
